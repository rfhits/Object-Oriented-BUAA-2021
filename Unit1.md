# Unit1

如果你想膜拜大佬，给你指条路——[Mistariano大佬的OO2019第二次作业源代码](https://github.com/HansBug/oo_course_2019_17373331_homework_2)

不要抄袭，当然如果你重构能力彪悍查重机奈何不了你也行。

## homework1

猜测有人遇到0不输出，结果最后带个加号

```
in: 2*x+1
out: 2+
```

建议直接从homework3入手，Jay1Zhang学长有存2019春OOhomework的描述。

## homework2

cos/sin里面只放x，这点简直就是救星啊

## bug

sin(x^2) pow 重写getDer，以为return的是pow，x^n->x^(n-1)

addCos忘了写

-+分割的充分条件，包含前面非-+

clone随意写，严格说，本人根本不会写clone，然后出错了

poly的tostring没括号，输出时如果补上括号就对了，但是因为优先级认为×，以为某些核心组件出问题了，实际上，只要加上()

## 优化

const+0，0不必输出

任何一个poly和term，都有去除两端括号，直到正常

## 可能的bug

1. 进行连续的加减符号替换式是只考虑了连续的两个加减符号，而未考虑连续的三个加减符号。
2. tab和空格分不清。判断空字符的正则表达式错误地写为了[\s]，但是应该写作[ \t]。
3. 省略了每一项前的系数`-1`中的`1`，而忘记去掉后面的`*`号了。例如，对于项 `-1*x`，我省略了其中的`1`，却没有去掉后面的`*`，结果输出了`-*x`。
4. 在嵌套的层数太多时，由于调用的方法太过复杂，程序计算时间会超时
5. 替换**前不做检查
6. `(x)*(x)*(x)`我会输出为`(x)**2`
7. `x**-1*-1`类似乘以负常数因子时，符号处理不当造成的bug。还有部分同学因为优化失误，造成了format error
8. 为了缩短字符串长度将x**2转换成x*x输出，但是如果多项式嵌套在三角函数中，这样的转换方式会导致表达式不合法。
9. `cos/sin`括号中的因子为带符号数时，如果符号和数字分开属于WF，但是我考虑时漏了这种情况。所在的类为main类，在进行WF判断是产生了漏判。
10. `cos/sin`的因子求导时括号省略出现问题，导致会出现输出结果形式不合法的情况。问题所在的类为sin、cos类，将因子求导的最终结果加上一个括号即可修复

## 样例

```
+++1+1+  +1+++1
sin(x**3)
(((((((((((((((x+1)*x+1)*x+1)*x+1)*x+1)*x+1)*x+1)*x+1)*x+1)*x+1)*x+1)*x+1)*x+1)*x+1)*x+1)*x+1
cos(+ 1)
x@x
-1*x
(x)*(x)*(x)*(x)
x**-1*-1

```
