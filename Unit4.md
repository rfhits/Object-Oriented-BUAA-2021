# Unit4

ä¸çŸ¥é“ä½ åäº†æ²¡æœ‰ï¼Œåæ­£æˆ‘æ˜¯åäº†ğŸ¤®ã€‚

å…ˆæ˜¯å®˜æ–¹åŒ…é‡Œè¦å¯¼å…¥é¢å¤–çš„åŒ…ï¼Œç„¶åæˆ‘çš„IDEA`find jar on web`æ²¡ååº”ï¼Œç„¶ååœ¨æˆ‘å›½çš„äº’è”ç½‘åƒåœ¾å †é‡Œç¿»äº†è®¸ä¹…ï¼ŒPéƒ½æ²¡æ‰¾åˆ°ã€‚

æ¥ç€åœ¨ä¼Ÿå¤§çš„Stackoverflowä¸Šï¼Œç»ˆäºæ‰¾åˆ°äº†è§£å†³æ–¹æ³•ã€‚

**æ³ªï¼Œå°„äº†å‡ºæ¥ã€‚**

è¿™æ‚²æƒ¨çš„é­é‡ï¼Œä¸ç¦æƒ³èµ·åšUnit3æ—¶ï¼Œæˆ‘ç«Ÿç„¶èŠ±äº†30åˆ†é’Ÿç ”ç©¶æ€ä¹ˆå¯¼åŒ…ã€‚

UmlElementé‡Œï¼Œä»€ä¹ˆæ˜¯Operationï¼Œä»€ä¹ˆæ˜¯Parameterï¼Ÿæˆ‘ä¸€è„¸è’™è”½ã€‚

ä¸ºä»€ä¹ˆå«Operationä¸å«Methodï¼Œï¼Œä½ ï¼Œï¼Œä½ å¯ä»¥å¼ºè¿«æˆ‘ç”¨Operationè¿™ä¸ªå•è¯ï¼Œä½†æ˜¯è¯¾ç¨‹ç»„ä½ å¾—ç»™æˆ‘ä¸ªç†ç”±çŸ¥é“å§ã€‚

åˆ°äº†ä¸‹åˆï¼Œæ…¢æ…¢çœ‹ï¼Œä¸å¾—ä¸è¯´ï¼Œè¿™OOæœ‰OSå†…å‘³äº†ï¼Œæ„Ÿè§‰è‡ªå·±åœ¨è§£è°œå•Šã€‚

## å†™åœ¨å‰é¢

å¦‚æœå¯¹UMLä¸€çªä¸é€šï¼Œé‚£è¿™ä¸ªå•å…ƒå¯ä»¥ç›´æ¥ç»“è¯¾äº†ã€‚

[UMLå¿«é€Ÿå…¥é—¨](https://blog.csdn.net/endlessseaofcrow/article/details/85855461)ã€‚

https://www.cnblogs.com/wolf-sun/p/UML-Sequence-diagram.html

ç‰¹åˆ«æ³¨æ„å®˜æ–¹åŒ…models/elementsä¸‹çš„é‚£äº›é—®ä»·ï¼Œå°±æ˜¯UMLç±»å›¾çš„â€œç»„ä»¶â€ã€‚

æƒ³è¦å¼„æ‡‚é‚£äº›è‹±æ–‡å•è¯ï¼Œå¯ä»¥çœ‹[è¿™ä¸ª](https://javapapers.com/oops/association-aggregation-composition-abstraction-generalization-realization-dependency/)ã€‚

æœ¬æ–‡ç« å‚è€ƒæ­¤[åšå®¢](https://www.cnblogs.com/puzzledAtticus/p/11076553.html)ã€‚

## è¦å¹²ä»€ä¹ˆ

éš¾ç‚¹åœ¨äºï¼Œæˆ‘ä»¬ä¸çŸ¥é“è¿™äº›Elementå…·ä½“æ˜¯å¹²ä»€ä¹ˆçš„ï¼Œä»¥åŠå„ä¸ªELementé‡Œé¢çš„æˆå‘˜å˜é‡æ˜¯åšä»€ä¹ˆçš„ï¼Œè¿™äº›ç±»å…·ä½“æœ‰å“ªäº›æ–¹æ³•ã€‚

### hw1

è¾“å…¥ç‰¹å®šæ ¼å¼çš„UmlElementï¼Œå°†å…¶å­˜å‚¨åˆ°å¯¹åº”çš„å®¹å™¨ï¼Œå¹¶æ„å»ºå…³ç³»ã€‚

å®ç°æŸ¥è¯¢æ—¶çš„æ¥å£ã€‚

ç‰¹ç‚¹ï¼š`add by id, query by name`

idä¿è¯ä¸é‡å¤ï¼ˆè¨€å¤–ä¹‹æ„ï¼Œnameä¿è¯å­˜åœ¨é‡å¤ï¼‰ã€‚

è¿˜æœ‰ä¸€ä¸ªæˆ‘ä¸ªäººè®¤ä¸ºéå¸¸æ¶å¿ƒçš„åœ°æ–¹ï¼Œ

åœ¨åŠ å…¥ï¼Œæˆ–è€…è¯´åˆå§‹åŒ–è¿™äº›å…ƒç´ çš„æ—¶å€™ï¼Œå°±åº”è¯¥åšExceptionsçš„checkï¼Œä¸åˆæ³•çš„ä¸œè¥¿å°±ä¸åº”è¯¥è¢«æ·»åŠ è¿›æ¥ï¼Œè€Œä¸æ˜¯æ”¾åˆ°queryçš„æ—¶å€™å†æ¥åšã€‚

æŒ‡å¯¼ä¹¦æœ‰äº›åœ°æ–¹å†™çš„ä¸æ¸…æ¥šæ˜¯è‚¯å®šçš„ï¼Œæ¯”å¦‚è¯´å¼‚å¸¸çš„æŠ›å‡ºï¼Œä¸è¿‡å¦‚æœæŒ‰ç…§æˆ‘ä»¬çš„æ€è·¯ï¼Œå‡½æ•°å¼ç¼–ç¨‹åœ°æ¥å†™æŒ‡å¯¼ä¹¦ï¼Œé‚£å°±æŠŠæ€è·¯éƒ½å‘Šè¯‰æˆ‘ä»¬äº†ï¼Œéš¾åº¦å°±ä¸‹å»ã€‚

### hw2

> ä¿è¯è¾“å…¥å‡ä»åˆæ³•UMLå›¾ä¸­å¯¼å‡ºï¼Œä½†å¯èƒ½ä¼šå­˜åœ¨éƒ¨åˆ†ä¸Šå±‚å…ƒç´ parentidä¸å­˜åœ¨çš„æƒ…å†µã€‚
>
> èµ·ç‚¹å’Œç»ˆç‚¹ç¡®å®æœ€å¤šåªæœ‰ä¸€ä¸ª

å¯èƒ½è¾“å…¥å¤šä¸ªState Machine Diagram

## Class Diagram

è¿™ç©æ„æœ€å¥½è‡ªåº•å‘ä¸Šçœ‹ã€‚

### UmlParameter

å‚æ•°

```java
private UmlParameter(AbstractElementData elementData, Direction direction, NameableType type) {
    super(elementData);
    this.direction = direction;
    this.type = type;
}
```

å°¤å…¶è¦æ³¨æ„type

### UmlOperation

```java
private UmlOperation(AbstractElementData elementData, Visibility visibility) {
    super(elementData);
    this.visibility = visibility;
}
```

éœ€è¦æˆ‘ä»¬å°è£…ï¼Œèƒ½å¤ŸåŒºåˆ†è¿™ä¸ªOperationæœ‰æ— è¿”å›å€¼ï¼Œæœ‰æ— æ¥æ”¶å‚æ•°ï¼Œè¿™äº›å‚æ•°æ˜¯ä»€ä¹ˆã€‚

æœ€å¥½å°è£…ä¸‹æ¥æ”¶çš„å‚æ•°ã€è¿”å›çš„å‚æ•°ï¼Œå› ä¸ºè¦ç»Ÿè®¡æ“ä½œçš„å‚æ•°ç±»å‹ã€‚

### UmlAttributes

```java
private UmlAttribute(AbstractElementData elementData, Visibility visibility, NameableType type) {
    super(elementData);
    this.visibility = visibility;
    this.type = type;
}
```

parentIdè¡¨ç¤ºæ˜¯å“ªä¸ªç±»çš„attrib

### UmlClass

```java
private UmlClass(AbstractElementData elementData, Visibility visibility) {
    super(elementData);
    this.visibility = visibility;
}
```

éœ€è¦å°è£…ã€‚

æŠŠattributeå’Œoperationæ”¾å¥½ã€‚

### UmlAssociationEnd

```java
private UmlAssociationEnd(AbstractElementData elementData, Visibility visibility, String multiplicity, String reference, Aggregation aggregation) {
    super(elementData);
    this.visibility = visibility;
    this.multiplicity = multiplicity;
    this.reference = reference;
    this.aggregation = aggregation;
}
```

åªæ˜¯ä¸€ç§é“¾æ¥åˆ°äº†æŸä¸ªUMLClassçš„ç»“æ„ã€‚

### UmlAssociation

åªæ˜¯è¡¨ç¤ºæŸç§é“¾æ¥çš„å…³ç³»ã€‚å¦‚`ä¼é¹…`å’Œ`æ°”å€™`ã€‚

é“¾æ¥åˆ°ä¸¤ä¸ªUMLAssociationEndçš„Idã€‚

> * UMLAssociation
>   + end1ï¼šå¯¹åº”å…¶ä¸­ä¸€ä¸ªUMLAssociationEndçš„Id
>   + end2ï¼šå¯¹åº”å¦å¤–ä¸€ä¸ªUMLAssociationEndçš„Id

ç„¶åæˆ‘ä»¬è¦é€šè¿‡Idè·å–åˆ°è¿™ä¸¤ä¸ªUMLAssociationEndï¼Œå†é€šè¿‡Endçš„getRefå¾—åˆ°ClassIdã€‚

### UmlInterface

æ³¨æ„æ¥å£ä¸æ¥å£ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ã€‚

å¯ä»¥ä¸ºæ¥å£ç»´æŠ¤è‡ªå·±çš„çˆ¶æ¥å£ï¼Œè¿™æ ·æŸ¥è¯¢ä¸€ä¸ªç±»å¯¹åº”æ‰€æœ‰çˆ¶æ¥å£æ—¶å¯ä»¥å¿«ã€‚

### UmlInterfaceRealization

```java
private UmlInterfaceRealization(AbstractElementData elementData, String source, String target) {
    super(elementData);
    this.source = source;
    this.target = target;
}
```

* **_parent**ï¼šåŒæˆå‘˜å˜é‡source
* sourceï¼šå¯¹åº”å®ç°è¯¥æ¥å£çš„ç±»çš„ID
* targetï¼šå¯¹åº”è¯¥æ¥å£çš„ID

### UmlGeneralization

è¡¨ç¤ºç»§æ‰¿ï¼Œå¦‚`Person`å’Œ`Student`ã€‚

* UMLGeneralization
  * **_parent**ï¼šåŒsourceï¼Œå¯¹åº”å­ç±»ID
  * sourceï¼šå¯¹åº”å­ç±»ID
  * targetï¼šå¯¹åº”çˆ¶ç±»ID

## State Machine Diagram

* çŠ¶æ€å›¾ç›¸å…³
  * ç¡®ä¿æ¯ä¸ªState Machineä¸­æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªRegionï¼›
  * ç¡®ä¿æ¯ä¸ªState Machineä¸­æœ€å¤šåªæœ‰ä¸€ä¸ªInitial Stateï¼Œæœ€å¤šåªæœ‰ä¸€ä¸ªFinal Stateï¼›
  * ç¡®ä¿æ¯ä¸ªState Machineä¸­Initial Stateå’ŒFinal Stateçš„nameå‡ä¸ºnullï¼ŒæŸ¥è¯¢æŒ‡ä»¤ä¸­ç»™å‡ºçš„çŠ¶æ€ä¹Ÿä¸ä¼šä¸ºInitial Stateæˆ–Final Stateï¼›
  * ç¡®ä¿æ¯ä¸ªState Machineä¸­ï¼Œä»æŸä¸ªçŠ¶æ€åˆ°å¦ä¸€ä¸ªçŠ¶æ€çš„ç›´æ¥è¿ç§»å‡å…·æœ‰ä¸åŒçš„Eventæˆ–Guardï¼Œå³ä»æŸä¸ªçŠ¶æ€åˆ°å¦ä¸€ä¸ªçŠ¶æ€çš„ç›´æ¥è¿ç§»è‹¥æœ‰å¤šä¸ªï¼Œåˆ™è¿™äº›è¿ç§»ä¸€å®šäº’ä¸ç›¸åŒï¼›
  * ç¡®ä¿æ¯ä¸ªState Machineä¸­ï¼ŒInitial Stateæ²¡æœ‰çŠ¶æ€è¿å…¥ï¼ŒFinal Stateæ²¡æœ‰çŠ¶æ€è¿å‡ºï¼›
  * ç¡®ä¿æ¯ä¸ªState Machineä¸­ä¸åŒ…å«å¤åˆçŠ¶æ€ã€‚
* *

### UmlStateMachine

å°±æ˜¯æ•´ä¸ªçŠ¶æ€æœºã€‚å†…å«çŠ¶æ€ï¼ˆStateï¼‰ï¼ŒTransition

### UmlRegion

é“¾æ¥åˆ°ä¸€ä¸ªçŠ¶æ€æœº


### UmlState

* `_parent`é“¾æ¥åˆ°ä¸€ä¸ª`UmlRegion`

### UmlFinalState

### UmlEvent

ä¸€ä¸ªäº‹ä»¶

* `_parent`é“¾æ¥åˆ°ä¸€ä¸ª`UmlTransition`
*

### UmlTransition

* `_parent`é“¾æ¥åˆ°ä¸€ä¸ª`UmlRegion`
*

### UmlRegion

* `_parent` é“¾æ¥åˆ°ä¸€ä¸ª`UmlStateMachine`
*

## Sequence Diagram

é¡ºåºå›¾ç›¸å…³ç¡®ä¿æ¯ä¸ªé¡ºåºå›¾ä¸­ï¼ŒLifelineå’Œå…¶Representå‡ä¸€ä¸€å¯¹åº”ã€‚

### UmlInteraction

æŠ½è±¡åœ°è¡¨ç¤ºäº†**æ•´ä¸ªé¡ºåºå›¾**

### UmlLifeLine

å°±æ˜¯é¡ºåºå›¾çš„å‚ä¸å¯¹è±¡

### UmlMessage

* `parent`é“¾æ¥åˆ°ä¸€ä¸ªUmlInteraction
* `targetId`é“¾æ¥åˆ°æ¥æ”¶æ¶ˆæ¯çš„å¯¹è±¡
* `sourceId`å“ªä¸ªlifelineå‘çš„
* `messageSort`ï¼Œè¡¨ç¤ºæ¶ˆæ¯çš„ç±»å‹ï¼ŒåŒæ­¥çš„ï¼Œè¿˜æ˜¯reply

## å°è£…

### MyClass

å°è£…ç±»

### MyOperation

å°è£…æ–¹æ³•ï¼Œå†…å«attribute

### MyInteraction

å°è£…æ•´ä¸ªé¡ºåºå›¾ï¼ˆSequence Diagramï¼‰

å†…å«LifeLineï¼ŒMessageã€‚

### MyStateMachine

å°è£…æ•´ä¸ªçŠ¶æ€å›¾ï¼Œ

å†…å«Stateï¼ŒTransition

## æŒ‡ä»¤

### getType()

UmlAttributeå’ŒUmlParameteréƒ½æœ‰ä¸€ä¸ªæˆå‘˜å˜é‡

```
private final NameableType type;
````

getType()ååˆ¤æ–­instanceå³å¯

```java
String type = null;
if (umlAttrib.getType() instanceof NamedType) {
    type = ((NamedType) umlAttrib.getType()).getName();
    if (!namedTypeSet.contains(type)) { // not contains
        throw new AttributeWrongTypeException(className, attributeName);
    }
else { 
  
}
```

### ç±»å±æ€§ç±»å‹

å‘ç‚¹ï¼š

1. ç±»å‹å¯ä»¥æ˜¯æ¥å£

### ç±»æ“ä½œçš„å‚æ•°ç±»å‹

**1ã€æ³¨æ„å¼‚å¸¸çš„æŠ›å‡ºé¡ºåº**

ç±»çš„å±æ€§ç±»å‹ä¼˜å…ˆæŠ›å‡ºé‡å¤å¼‚å¸¸ï¼Œå†æŠ›å‡ºç±»å‹é”™è¯¯å¼‚å¸¸ã€‚è€Œç±»çš„æ“ä½œçš„å‚æ•°ç±»å‹æ˜¯ä¼˜å…ˆæŠ›å‡ºç±»å‹é”™è¯¯å¼‚å¸¸ï¼Œå†æŠ›å‡ºé‡å¤å¼‚å¸¸ã€‚

**2ã€è·å–åŸºæœ¬ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„nameæ–¹å¼ä¸ä¸€æ ·**

åŸºæœ¬ç±»å‹çš„nameæ˜¯é€šè¿‡JsonStringçš„substringè·å¾—çš„ã€‚è€Œå¼•ç”¨ç±»å‹çš„nameæ˜¯è¦é€šè¿‡referenceIdæ‰¾åˆ°å¯¹åº”çš„ç±»æˆ–è€…æ¥å£ï¼Œå†getnameè·å¾—çš„ï¼Œæ³¨æ„ï¼Œå¼•ç”¨ç±»å‹å¯èƒ½æ˜¯**ç±»**ä¹Ÿå¯èƒ½æ˜¯**æ¥å£**ã€‚

**3ã€å…³è”å’Œç»§æ‰¿å’Œå®ç°**

* associationåªéœ€è¦ä¿å­˜ç±»å’Œç±»ä¹‹é—´çš„ã€‚
* generalizationéœ€è¦ä¿å­˜ç±»å’Œç±»ä¹‹é—´çš„ä»¥åŠæ¥å£å’Œæ¥å£ä¹‹é—´çš„ï¼ŒåŒæ—¶è¦æ³¨æ„ç±»å’Œç±»ä¹‹é—´åªå¯èƒ½æœ‰ä¸€æ¬¡ç»§æ‰¿ï¼Œä¸€ä¸ªæ¥å£å´å¯ä»¥ç»§æ‰¿å¤šä¸ªæ¥å£ã€‚
* åªå¯èƒ½æ˜¯ç±»å®ç°æ¥å£ã€‚
* targetæ˜¯è¢«ç»§æ‰¿/å®ç°çš„å¯¹è±¡ï¼Œsourceæ˜¯å­ç±»/å®ç°æ¥å£çš„ç±»ã€‚

**4ã€æ³¨æ„ä¸é‡ä¸æ¼**

å»ºè®®ç”¨ä¸€ä¸ªidçš„listæˆ–è€…<id,name>çš„hashmapä¿è¯ä¸é‡ä¸æ¼ã€‚

**5ã€å‚æ•°å’Œè¿”å›å€¼çš„åŸºæœ¬ç±»å‹æƒ…å†µä¸åŒ**

è¿”å›å€¼çš„åŸºæœ¬ç±»å‹å¤šäº†ä¸€ç§voidï¼Œåˆ¤æ–­çš„æ—¶å€™éœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚

**6ã€æ³¨æ„æ¯ä¸ªæŒ‡ä»¤å•ç‹¬çš„æ³¨æ„äº‹é¡¹**

å¦‚éœ€ä¸éœ€è¦è€ƒè™‘ç»§æ‰¿è‡ªçˆ¶ç±»çš„å±æ€§ï¼Œå‡ºç°åŒåå±æ€§æ˜¯æŠ›å‡ºå¼‚å¸¸è¿˜æ˜¯åˆ†åˆ«è®¡æ•°ï¼ˆæ¯ä¸ªæŒ‡ä»¤çš„è¦æ±‚ä¸å°½ç›¸åŒï¼‰ã€‚

æ³¨æ„è¿”å›çš„æ˜¯`List<OperationParamInformation>`

* parameterTypesä¸­éœ€è¦åŒ…å«**é™¤äº†è¿”å›å€¼**çš„æ‰€æœ‰å‚æ•°ç±»å‹ã€‚
* éœ€è¦åˆ¤æ–­è¯¥æ“ä½œæ˜¯å¦æœ‰è¿”å›å€¼ï¼Œè‹¥æœ‰ï¼Œåˆ™å°†returnTypeè®¾ç½®ä¸ºç›¸åº”ç±»å‹ï¼›è‹¥æ²¡æœ‰è¿”å›å€¼ï¼Œåˆ™å°†returnTypeè®¾ç½®ä¸ºnullï¼Œ**æ³¨æ„ï¼Œè¿™é‡Œçš„nullä¸ºå…³é”®å­—nullï¼Œè€Œéå­—ç¬¦ä¸²â€œnullâ€**ã€‚
* å¯¹äº**è¿”å›å€¼ç±»å‹æ­£ç¡®æ€§**çš„åˆ¤æ–­ä¸ä¹‹å‰ä¸åŒï¼Œæ­£ç¡®ç±»å‹å¤šäº†ä¸ª**void**ã€‚
* æ³¨æ„å­˜åœ¨é”™è¯¯ç±»å‹å’Œé‡å¤æ“ä½œçš„å¼‚å¸¸ä¼˜å…ˆçº§ï¼Œæ ¹æ®è¦æ±‚æ˜¯å­˜åœ¨é”™è¯¯ç±»å‹å¼‚å¸¸ä¼˜å…ˆçº§**é«˜äº**é‡å¤æ“ä½œå¼‚å¸¸ã€‚

inå‚æ•°ç±»å‹å…è®¸æ˜¯void

OperationParamInformationçš„`equals`æ–¹æ³•å¯ä»¥ç›´æ¥ç”¨æ¥æ¯”è¾ƒ

MyOperationå†…éƒ¨æ— æ³•ç”ŸæˆInfoï¼Œå¿…é¡»æ”¾å‡ºæƒé™è®©Interç”Ÿæˆã€‚å³åŒ…å«getæ–¹æ³•ã€‚

1. ç¡®è®¤Nameå¯¹åº”çš„Classåªæœ‰ä¸€ä¸ª
2. å–å‡ºè¯¥Class
3. Classæä¾›ç»™å‡ºOpNameè¿”å›ä¸€ä¸ªOperationSetçš„å‡½æ•°ï¼Œå–å‡ºæ‰€æœ‰ä¸ºæ­¤Nameçš„Op
4. OpSetç°åœ¨åœ¨Interä¸­ï¼Œéå†Setï¼Œä¸ºæ¯ä¸ªOpç”ŸæˆParaInfoï¼Œå¯æŠ›å‡ºå¼‚å¸¸
5. å°†Infoæ”¶é›†ï¼Œåœ¨Infoè¿›å…¥listå‰ï¼Œåšcontainsåˆ¤æ–­
   1. è‹¥å·²ç»å«ï¼Œåˆ™æŠ›å¼‚å¸¸
   2. è‹¥ä¸å«ï¼Œåˆ™æ”¾å…¥list
6. å°†infolistè¿”å›

### è§¦å‘æ¡ä»¶

å…ˆéå†transitionï¼Œç¡®è®¤å­˜åœ¨æ€§

éå†eventï¼Œæ ¹æ®parentIdæ‰¾åˆ°transitionï¼Œå°†eventNameæ”¶é›†

### incoming Message

æ¥æ”¶åˆ°çš„æ¶ˆæ¯çš„ä¸ªæ•°ã€‚

### å‘é€çš„å¯¹åº”ç±»å‹æ¶ˆæ¯çš„ä¸ªæ•°


## bug

### hw1


### hw2

#### 1

```java
for {
    for (element ) {
        sort
        setUp()
    }
}
```

setUpåº”è¯¥åœ¨forä¹‹å

#### 2

ç»Ÿè®¡æ•°é‡ï¼Œå®¹å™¨ç”¨é”™

```
if (seqName2MySeq.containsKey(interName)) {
            mySeqName2Num.put(interName, mySeqName2Num.get(interName) + 1);
        } else {
            mySeqName2Num.put(interName, 1);
        }
```
